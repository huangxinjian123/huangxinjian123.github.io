<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MYSQL复习 | 天上星星亮晶晶</title><meta name="author" content="huangxinjian"><meta name="copyright" content="huangxinjian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MYSQL复习一、分类 二、DDL表查询 表创建  修改表    应用：   三、mysql数据类型数值类型 无符号 UNSIGNED 年龄要求正数（UNSIGNED）且位数不多（TINYINT） 1age TINYINT UNSIGNED  字符类型 定长和变长的区别，varchar用多少就是多少空间，char写多少是多少 varchar(10) char(10) varchar性能差 场景：u">
<meta property="og:type" content="article">
<meta property="og:title" content="MYSQL复习">
<meta property="og:url" content="http://example.com/2024/10/10/Mysql/index.html">
<meta property="og:site_name" content="天上星星亮晶晶">
<meta property="og:description" content="MYSQL复习一、分类 二、DDL表查询 表创建  修改表    应用：   三、mysql数据类型数值类型 无符号 UNSIGNED 年龄要求正数（UNSIGNED）且位数不多（TINYINT） 1age TINYINT UNSIGNED  字符类型 定长和变长的区别，varchar用多少就是多少空间，char写多少是多少 varchar(10) char(10) varchar性能差 场景：u">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg">
<meta property="article:published_time" content="2024-10-10T02:05:36.000Z">
<meta property="article:modified_time" content="2024-10-10T02:08:53.178Z">
<meta property="article:author" content="huangxinjian">
<meta property="article:tag" content="MYSQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg"><link rel="shortcut icon" href="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/R-C.png"><link rel="canonical" href="http://example.com/2024/10/10/Mysql/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MYSQL复习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-10 10:08:53'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/R-C.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="天上星星亮晶晶"><span class="site-name">天上星星亮晶晶</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MYSQL复习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-10T02:05:36.000Z" title="发表于 2024-10-10 10:05:36">2024-10-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-10T02:08:53.178Z" title="更新于 2024-10-10 10:08:53">2024-10-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MYSQL复习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="MYSQL复习"><a href="#MYSQL复习" class="headerlink" title="MYSQL复习"></a>MYSQL复习</h1><h2 id="一、分类"><a href="#一、分类" class="headerlink" title="一、分类"></a>一、分类</h2><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920143148956.png" alt="image-20240920143148956"></p>
<h2 id="二、DDL"><a href="#二、DDL" class="headerlink" title="二、DDL"></a>二、DDL</h2><h3 id="表查询"><a href="#表查询" class="headerlink" title="表查询"></a>表查询</h3><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920143429697.png" alt="image-20240920143429697"></p>
<h3 id="表创建"><a href="#表创建" class="headerlink" title="表创建"></a>表创建</h3><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920144245508.png" alt="image-20240920144245508" style="zoom:67%;" />

<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920151000143.png" alt="image-20240920151000143" style="zoom:67%;" />

<img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920151220402.png" alt="image-20240920151220402" style="zoom:67%;" />

<p>应用：</p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920151739857.png" alt="image-20240920151739857"></p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920151840541.png" alt="image-20240920151840541"></p>
<h2 id="三、mysql数据类型"><a href="#三、mysql数据类型" class="headerlink" title="三、mysql数据类型"></a>三、mysql数据类型</h2><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a><strong>数值类型</strong></h3><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920144911488.png" alt="image-20240920144911488"></p>
<p>无符号 UNSIGNED</p>
<p>年龄要求正数（UNSIGNED）且位数不多（TINYINT）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age TINYINT UNSIGNED</span><br></pre></td></tr></table></figure>

<h3 id="字符类型"><a href="#字符类型" class="headerlink" title="字符类型"></a>字符类型</h3><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920145636140.png" alt="image-20240920145636140"></p>
<p>定长和变长的区别，varchar用多少就是多少空间，char写多少是多少</p>
<p>varchar(10) char(10)</p>
<p>varchar性能差</p>
<p>场景：username用varchar (因为username长度不一定)，同理性别这类属性不是男就是女，可以用char(1)</p>
<h3 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h3><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920150142016.png" alt="image-20240920150142016"></p>
<p><strong>应用：</strong></p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/image-20240920150539267.png" alt="image-20240920150539267"></p>
<h2 id="未知、索引和索引优化"><a href="#未知、索引和索引优化" class="headerlink" title="未知、索引和索引优化"></a>未知、索引和索引优化</h2><h3 id="1-索引优劣势"><a href="#1-索引优劣势" class="headerlink" title="1.索引优劣势"></a>1.索引优劣势</h3><h4 id="1-1索引优势"><a href="#1-1索引优势" class="headerlink" title="1.1索引优势"></a>1.1索引优势</h4><p>提高数据检索的效率，降低数据库的IO成本。（树每加一层就要io多一次）<br>通过索引对数据进行排序，降低数据排序的成本，降低了CPU的消耗。</p>
<h4 id="1-2索引劣势"><a href="#1-2索引劣势" class="headerlink" title="1.2索引劣势"></a>1.2索引劣势</h4><p>索引实际上也是一张表，保存了主键和索引的字段，并且指向实体表的记录，所以索引也是需要占用空间的。在索引大大提高查询速度的同时，却会降低表的更新速度，在对表进行数据增删改的同时，MySQL不仅要更新数据，还需要保存一下索引文件。每次更新添加了的索引列的字段，都会去调整因为更新带来的减值变化后的索引的信息。</p>
<h4 id="1-3索引使用场景"><a href="#1-3索引使用场景" class="headerlink" title="1.3索引使用场景"></a>1.3索引使用场景</h4><p>哪些情况需要创建索引：<br>1.主键自动建立唯一索引<br>2.频繁作为查询条件的字段应该创建索引(where 后面的语句)<br>3.查询中与其它表关联的字段，外键关系建立索引<br>4.多字段查询下倾向创建组合索引<br>5.查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度<br>6.查询中统计或者分组字段</p>
<p>哪些情况不推荐建立索引:<br>1.表记录太少<br>2.经常增删改的表<br>3.Where条件里用不到的字段不建立索引</p>
<h3 id="2-索引分类"><a href="#2-索引分类" class="headerlink" title="2.索引分类"></a>2.索引分类</h3><p>随表创建索引</p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/cfafe2fdcb3c87c74e6c4f8267c844f1.png" alt="在这里插入图片描述"></p>
<h4 id="2-1主键索引"><a href="#2-1主键索引" class="headerlink" title="2.1主键索引"></a>2.1主键索引</h4><p>1.表中的列设定为主键后，数据库会自动建立主键索引。<br>2.单独创建和删除主键索引语法：<br>创建主键索引语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add primary key (字段);</span><br></pre></td></tr></table></figure>

<p>删除主键索引语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop primary key;</span><br></pre></td></tr></table></figure>

<h4 id="2-2唯一索引"><a href="#2-2唯一索引" class="headerlink" title="2.2唯一索引"></a>2.2唯一索引</h4><p>1.表中的列创建了唯一约束时，数据库会自动建立唯一索引。<br>2.单独创建和删除唯一索引语法：<br>创建唯一索引语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add unique 索引名(字段)；--修改为唯一约束自动生成唯一索引</span><br><span class="line">或者  </span><br><span class="line">create unique index 索引名 on 表名(字段)；</span><br></pre></td></tr></table></figure>

<p>删除唯一索引语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名 on 表名;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-单值索引"><a href="#2-3-单值索引" class="headerlink" title="2.3 单值索引"></a>2.3 单值索引</h4><p>即一个索引只包含单个列，一个表可以有多个单值索引。<br>1.建表时可随表一起建立单值索引<br>2.单独创建和删除单值索引：<br>创建单值索引：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add index 索引名(字段);</span><br><span class="line">或者   </span><br><span class="line">create index 索引名 on 表名(字段);</span><br></pre></td></tr></table></figure>

<p>删除单值索引：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名 on 表名;</span><br></pre></td></tr></table></figure>

<h4 id="2-4组合索引"><a href="#2-4组合索引" class="headerlink" title="2.4组合索引"></a>2.4组合索引</h4><p>即一个索引包含多个列：<br>1.建表时可随表一起建立复合索引<br>2.单独创建和删除复合索引：<br>创建复合索引：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create index 索引名 on 表名(字段1,字段2);</span><br><span class="line">或者 </span><br><span class="line">alter table 表名 add index 索引名(字段,字段2);</span><br></pre></td></tr></table></figure>


<p>删除复合索引:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名 on 表名; </span><br></pre></td></tr></table></figure>

<h3 id="3-性能分析-EXPLAIN"><a href="#3-性能分析-EXPLAIN" class="headerlink" title="3.性能分析(EXPLAIN)"></a>3.性能分析(EXPLAIN)</h3><h4 id="3-1-Explain"><a href="#3-1-Explain" class="headerlink" title="3.1 Explain"></a>3.1 Explain</h4><p>使用EXPLAIN关键字可以模拟优化器执行SQL查询语句，从而知道MYSQL是如何处理SQL语句的。可以用来分析查询语句或是表的结构的性能瓶颈。其作用:<br>1）表的读取顺序<br>2）哪些索引可以使用<br>3）数据读取操作的操作类型<br>4）那些索引被实际使用<br>5）表之间的引用<br>6）每张表有多少行被优化器查询<br>EXPLAIN关键字使用起来比较简单： explain + SQL语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">--  创建四张测试表</span><br><span class="line">CREATE TABLE t1(</span><br><span class="line">	id INT(10) AUTO_INCREMENT,</span><br><span class="line">	content  VARCHAR(100),  </span><br><span class="line">	PRIMARY KEY (id)</span><br><span class="line">);</span><br><span class="line">CREATE TABLE t2(</span><br><span class="line">	id INT(10) AUTO_INCREMENT,</span><br><span class="line">	content  VARCHAR(100),</span><br><span class="line">	PRIMARY KEY (id)</span><br><span class="line">);</span><br><span class="line">CREATE TABLE t3(</span><br><span class="line">	id INT(10) AUTO_INCREMENT,</span><br><span class="line">	content  VARCHAR(100),</span><br><span class="line">	PRIMARY KEY (id)</span><br><span class="line">	);</span><br><span class="line">CREATE TABLE t4(</span><br><span class="line">	id INT(10) AUTO_INCREMENT,</span><br><span class="line">	content  VARCHAR(100),</span><br><span class="line">	PRIMARY KEY (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 每张表中添加一条数据</span><br><span class="line">INSERT INTO t1(content) VALUES(CONCAT(&#x27;t1_&#x27;,FLOOR(1+RAND()*1000)));</span><br><span class="line"></span><br><span class="line">INSERT INTO t2(content) VALUES(CONCAT(&#x27;t2_&#x27;,FLOOR(1+RAND()*1000)));</span><br><span class="line"></span><br><span class="line">INSERT INTO t3(content) VALUES(CONCAT(&#x27;t3_&#x27;,FLOOR(1+RAND()*1000)));</span><br><span class="line">	</span><br><span class="line">INSERT INTO t4(content) VALUES(CONCAT(&#x27;t4_&#x27;,FLOOR(1+RAND()*1000)));</span><br></pre></td></tr></table></figure>

<h4 id="3-2-id"><a href="#3-2-id" class="headerlink" title="3.2 id"></a>3.2 id</h4><p>select查询的序列号，表示查询中执行select子句或操作表的顺序。</p>
<p><strong>id相同时</strong>，执行顺序由上至下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#id相同时，执行顺序是从上往下</span><br><span class="line">explain select * from t1,t2,t3 where t1.id=t2.id and t2.id = t3.id;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/2968d8aac2ee7b4ed2f9b4a91fdad5f7.png" alt="img"></p>
<p><strong>id不同时</strong>，如果是子查询，id的序号会递增，id值越大优先级越高，则先被执行：</p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/ae499ed1c1a47cc86b48518b4410e6fa.png" alt="在这里插入图片描述"></p>
<p><strong>id相同和不同都存在时</strong>，id相同的可以理解为一组，从上往下顺序执行，所有组中，id值越大，优先级越高越先执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#id相同和id不同</span><br><span class="line">explain select t2.* from t2,(select * from t3) s3 where s3.id = t2.id;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/92410a914e080a81ec29e056710cbece.png" alt="在这里插入图片描述"></p>
<h4 id="3-3-查询类型（select-type）"><a href="#3-3-查询类型（select-type）" class="headerlink" title="3.3 查询类型（select_type）"></a>3.3 查询类型（select_type）</h4><p>查询的类型，常见值有：<br><strong>SIMPLE</strong> :简单的 select 查询,查询中不包含子查询或者UNION。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#simple 简单的select查询</span><br><span class="line">explain select * from t1;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/cca038fc1352755462d29d0055fe8d0c.png" alt="在这里插入图片描述"></p>
<p><strong>PRIMARY</strong>:查询中若包含任何复杂的子部分，最外层查询则被标记为Primary。</p>
<p><strong>DERIVED</strong>:在FROM列表中包含的子查询被标记为DERIVED(衍生),MySQL会递归执行这些子查询, 把结果放在临时表里。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#derived  primary</span><br><span class="line">explain select * from (select t1.content from t1) s1;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/55ca7cc464a83f4a26040c98f7e9b6ec.png" alt="在这里插入图片描述"></p>
<p><strong>SUBQUERY</strong>: 在SELECT或WHERE列表中包含了子查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#subquery</span><br><span class="line">explain select t2.* from t2 where t2.id = (select t3.id from t3);</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/55ca7cc464a83f4a26040c98f7e9b6ec.png" alt="在这里插入图片描述"></p>
<h4 id="3-4-table"><a href="#3-4-table" class="headerlink" title="3.4 table"></a>3.4 table</h4><p>显示这一行的数据是关于哪张表的。</p>
<h4 id="3-5-type"><a href="#3-5-type" class="headerlink" title="3.5 type"></a>3.5 type</h4><p>访问类型排序</p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/d14aeae4a0de28d8a1fcc403be7fd8dd.png" alt="在这里插入图片描述"></p>
<h5 id="System："><a href="#System：" class="headerlink" title="System："></a><strong>System</strong>：</h5><p><strong>表只有一行记录（等于系统表），这是const类型的特列，平时不会出现，这个也可以忽略不计。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#system</span><br><span class="line">explain select * from (select t1.id from t1 where id = 1) t;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/5232985080701913c25fe963e2dbff66.png" alt="在这里插入图片描述"></p>
<h5 id="Const："><a href="#Const：" class="headerlink" title="Const："></a><strong>Const</strong>：</h5><p><strong>表示通过索引一次就找到了,const用于比较primary key或者unique索引。因为只匹配一行数据，所以很快，如将主键置于where列表中，MySQL就能将该查询转换为一个常量。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#const 索引一次就找到了</span><br><span class="line">explain select * from t1 where id = 1;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/3c06c28315e8f25178a563f45e1ff6ba.png" alt="在这里插入图片描述"></p>
<h5 id="eq-ref："><a href="#eq-ref：" class="headerlink" title="eq_ref："></a><strong>eq_ref</strong>：</h5><p><strong>唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95&spm=1001.2101.3001.7020">唯一索引</a>扫描。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#eq_ref</span><br><span class="line">explain select t1.*,t2.* </span><br><span class="line">from t1</span><br><span class="line">join t2</span><br><span class="line">on t1.id = t2.id;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/803d0ea3a40b11ef43b19313b60e1b76.png" alt="在这里插入图片描述"></p>
<h5 id="Ref："><a href="#Ref：" class="headerlink" title="Ref："></a><strong>Ref</strong>：</h5><p><strong>非唯一性索引扫描，返回匹配某个单独值的所有行。本质上也是一种索引访问，它返回所有匹配某个单独值的行，然而，它可能会找到多个符合条件的行，所以他应该属于查找和扫描的混合体。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#ref非唯一索引扫描</span><br><span class="line">alter table t1 add index idx_t1_content(content);</span><br><span class="line">explain select * from t1 where t1.content = &quot;abc&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/6712215867b7d9cf52e0816b0a5d51e2.png" alt="在这里插入图片描述"></p>
<h5 id="Range："><a href="#Range：" class="headerlink" title="Range："></a><strong>Range</strong>：</h5><p><strong>只检索给定范围的行,使用一个索引来选择行。key 列显示使用了哪个索引</strong><br><strong>一般就是在你的where语句中出现了between、&lt;、&gt;、in等的查询这种范围扫描索引扫描比全表扫描要好，因为它只需要开始于索引的某一点，而结束语另一点，不用扫描全部索引。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#range</span><br><span class="line">explain select * from t2 where t2.id &gt;0;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/fe8e1c9986bdd3cf255f789b8d717aff.png" alt="在这里插入图片描述"></p>
<h5 id="Index："><a href="#Index：" class="headerlink" title="Index："></a><strong>Index</strong>：</h5><p><strong>Full Index Scan，index与ALL区别为index类型只遍历索引树。这通常比ALL快，因为索引文件通常比数据文件小。也就是说虽然all和Index都是读全表，但index是从索引中读取的，而all是从硬盘中读的。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#index</span><br><span class="line">explain select id,content from t1;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/3bf9fee1b8f0f3aa1d355ec85b199563.png" alt="在这里插入图片描述"></p>
<h5 id="All："><a href="#All：" class="headerlink" title="All："></a><strong>All</strong>：</h5><p><strong>Full Table Scan，将遍历全表以找到匹配的行。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#All</span><br><span class="line">explain select * from t1 where t1.content = &quot;abc&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/65aaf83cd70fb7348ccae66ba5e6f3ad.png" alt="在这里插入图片描述"></p>
<h5 id="性能对比"><a href="#性能对比" class="headerlink" title="性能对比"></a>性能对比</h5><p>性能从最好到最差依次是:<strong>system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;All</strong> 。<strong>一般来说，最好保证查询能达到range级别，最好能达到ref</strong>。</p>
<h4 id="4-possible-keys"><a href="#4-possible-keys" class="headerlink" title="4.possible_keys"></a>4.possible_keys</h4><p>显示可能应用在这张表中的索引，一个或多个。查询涉及到的字段上如果存在索引，则改索引将会被列出来，但不一定会被查询实际使用上。</p>
<h4 id="5-key"><a href="#5-key" class="headerlink" title="5.key"></a>5.key</h4><p>查询中实际使用的索引，如果为NULL，则没有使用索引。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- possible keys   key</span><br><span class="line">explain select * from t2 where t2.id is not null;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/b97619e11eef92cdf4485733908fbdab.png" alt="在这里插入图片描述"></p>
<h4 id="6-ref"><a href="#6-ref" class="headerlink" title="6.ref"></a>6.ref</h4><p>显示索引的哪一列被使用了。哪些列或常量被用于查找索引列上的值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- ref</span><br><span class="line">explain select t2.*,t3.* from t2,t3 where t2.id = t3.id;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/c53f853e248cfc3ce96e344450dfc1d1.png" alt="在这里插入图片描述"></p>
<h4 id="7-rows"><a href="#7-rows" class="headerlink" title="7.rows"></a>7.rows</h4><p>rows列显示MySQL认为它执行查询时必须检查的行数。一般越少越好。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- rows </span><br><span class="line">#删除person上的索引</span><br><span class="line">drop index idx_pname on person;</span><br><span class="line">alter table person add index idx_pname(PNAME);</span><br><span class="line">explain select person.* from person where pname = &quot;test3263609&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/c71d0b37c73bae3c623ed58d0b81a6e1.png" alt="在这里插入图片描述"></p>
<h4 id="8-Extra"><a href="#8-Extra" class="headerlink" title="8.Extra"></a>8.Extra</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">drop table if exists emps;</span><br><span class="line">CREATE TABLE emps (</span><br><span class="line">  id INT PRIMARY KEY AUTO_INCREMENT COMMENT &quot;主键id&quot;,</span><br><span class="line">  name VARCHAR (24) COMMENT &#x27;姓名&#x27;,</span><br><span class="line">  age INT COMMENT &#x27;年龄&#x27;,</span><br><span class="line">  job VARCHAR (20) COMMENT &#x27;职位&#x27;</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">INSERT INTO emps(name,age,job) VALUES(&#x27;zhangsan&#x27;,22,&#x27;manager&#x27;);</span><br><span class="line">INSERT INTO emps(name,age,job) VALUES(&#x27;lisi&#x27;,23,&#x27;clerk&#x27;);</span><br><span class="line">INSERT INTO emps(name,age,job) VALUES(&#x27;wangwu&#x27;,24,&#x27;salsman&#x27;);</span><br><span class="line">INSERT INTO emps(name,age,job) VALUES(&#x27;赵六&#x27;,23,&#x27;salsman&#x27;);</span><br></pre></td></tr></table></figure>

<p>一些常见的重要的额外信息：</p>
<h5 id="Using-filesort："><a href="#Using-filesort：" class="headerlink" title="Using filesort："></a><strong>Using filesort</strong>：</h5><p>MySQL无法利用索引完成的排序操作称为“文件排序”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- using filesort 排序时没有使用索引</span><br><span class="line">explain select * from emps order by age;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/9f8ce5ec593b0f92a68de8150074c3a3.png" alt="在这里插入图片描述"></p>
<h5 id="Using-temporary："><a href="#Using-temporary：" class="headerlink" title="Using temporary："></a><strong>Using temporary</strong>：</h5><p>Mysql在对查询结果排序时使用临时表，常见于排序order by和分组查询group by。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- using temporary 分组时没有使用索引</span><br><span class="line">explain select count(*),job from emps group by job;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/d02e778d0ca7326181c5bb8597ac8a5e.png" alt="在这里插入图片描述"></p>
<h5 id="Using-index："><a href="#Using-index：" class="headerlink" title="Using index："></a><strong>Using index</strong>：</h5><p>表示索引被用来执行索引键值的查找，避免访问了表的数据行，效率不错。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- using index </span><br><span class="line">explain select id,name from emps;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/efa896f29d52393f5482694e9062fff3.png" alt="在这里插入图片描述"></p>
<p><strong>Using where</strong>：</p>
<p>表示使用了where过滤。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- using where</span><br><span class="line">explain select * from emps where name = &quot;张三&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/9b72c17500263dd5a658acbde8c40cb0.png" alt="在这里插入图片描述"></p>
<h3 id="4-查询优化（索引失效）"><a href="#4-查询优化（索引失效）" class="headerlink" title="4.查询优化（索引失效）"></a>4.查询优化（索引失效）</h3><h4 id="1、最佳左前缀法则："><a href="#1、最佳左前缀法则：" class="headerlink" title="1、最佳左前缀法则："></a>1、最佳左前缀法则：</h4><p>如果索引了多列，要遵循最左前缀法则，指的是查询从索引的最左前列开始并且不跳过索引中的列。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">alter table students add index idx_sname_age_score(sname,age,score);</span><br><span class="line"></span><br><span class="line">-- 索引失效情况</span><br><span class="line">① explain select * from students where sname=&quot;小明&quot; and age = 22 and score = 100;</span><br><span class="line">② explain select * from students where sname=&quot;小明&quot; and age = 22;</span><br><span class="line">③ explain select * from students where sname=&quot;小明&quot;;</span><br><span class="line">④ explain select * from students where sname=&quot;小明&quot; and score = 80;</span><br></pre></td></tr></table></figure>


<p><strong>可以看到①②都遵守最佳左前缀法则，但是②的where条件没有完全覆盖包含索引的列，所以①的key_len相对较高，即索引使用率高</strong><br><strong>③遵守但是④不遵守，两者都锁定了sname，但是score使索引不再生效，所以③④的索引使用率一样</strong><br><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/208e0af8549cd07d4aeb40d6d687d9c7.png" alt="在这里插入图片描述"></p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/9b5b4eba0ca1c688d5d9621512513c6d.png" alt="在这里插入图片描述"></p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/63b0afc266023c63f6bdfad8b3a7e663.png" alt="在这里插入图片描述"></p>
<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/ff992ac945a91e6e3d9a8cceb247713d.png" alt="在这里插入图片描述"></p>
<h4 id="2、不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。"><a href="#2、不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。" class="headerlink" title="2、不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。"></a>2、不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。</span><br><span class="line">explain select * from students where left(sname,2) = &quot;小明&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/5f81d67c6be52c0bde9224eceab6078e.png" alt="在这里插入图片描述"></p>
<h4 id="3-存储引擎不能使用索引中范围条件右边的列。"><a href="#3-存储引擎不能使用索引中范围条件右边的列。" class="headerlink" title="3.存储引擎不能使用索引中范围条件右边的列。"></a>3.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E&spm=1001.2101.3001.7020">存储引擎</a>不能使用索引中范围条件右边的列。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 存储引擎不能使用索引中范围条件右边的列。</span><br><span class="line">explain select * from students where sname=&quot;小明&quot; and age &gt; 22 and score = 100;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/a50971dca233fb87eaac88bcd04ae22f.png" alt="在这里插入图片描述"></p>
<h4 id="4、Mysql在使用不等于时无法使用索引会导致全表扫描。"><a href="#4、Mysql在使用不等于时无法使用索引会导致全表扫描。" class="headerlink" title="4、Mysql在使用不等于时无法使用索引会导致全表扫描。"></a>4、Mysql在使用不等于时无法使用索引会导致全表扫描。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- Mysql在使用不等于时无法使用索引会导致全表扫描。</span><br><span class="line">explain select * from students where sname!=&quot;小明&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/ebc62e2ded4783bb548445aae6f129d2.png" alt="在这里插入图片描述"></p>
<h4 id="5、is-null可以使用索引，但是is-not-null无法使用索引。"><a href="#5、is-null可以使用索引，但是is-not-null无法使用索引。" class="headerlink" title="5、is null可以使用索引，但是is not null无法使用索引。"></a>5、is null可以使用索引，但是is not null无法使用索引。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- is null可以使用索引，但是is not null无法使用索引。</span><br><span class="line">explain select * from students where sname is not null;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/d340bdeab262d56a68b1fce1571e24ff.png" alt="在这里插入图片描述"></p>
<h4 id="6、like以通配符开头会使索引失效导致全表扫描。"><a href="#6、like以通配符开头会使索引失效导致全表扫描。" class="headerlink" title="6、like以通配符开头会使索引失效导致全表扫描。"></a>6、like以通配符开头会使索引失效导致全表扫描。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- like以通配符开头会使索引失效导致全表扫描。</span><br><span class="line">explain select * from students where sname like &quot;%黑%&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/f3eaed2ce411638cd7d53bb1fc114b07.png" alt="在这里插入图片描述"></p>
<h4 id="7、字符串不加单引号索引会失效。"><a href="#7、字符串不加单引号索引会失效。" class="headerlink" title="7、字符串不加单引号索引会失效。"></a>7、字符串不加单引号索引会失效。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 字符串不加单引号索引会失效。</span><br><span class="line">explain select * from students where sname = 123;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/f1e5e1979e8a35789497ea4a485a9b2e.png" alt="在这里插入图片描述"></p>
<h4 id="8、使用or连接时索引失效。"><a href="#8、使用or连接时索引失效。" class="headerlink" title="8、使用or连接时索引失效。"></a>8、使用or连接时索引失效。</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 使用or连接时索引失效。</span><br><span class="line">explain select * from students where sname=&quot;小明&quot; or age = 22;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/2a4bb04e733ac8c329fc2e520afa1279.png" alt="在这里插入图片描述"></p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/9017b9c3889b8316e3f56bb9643f8b83.png" alt="在这里插入图片描述"></p>
<p><strong>建议：</strong><br><strong>1.对于单值索引，尽量选择针对当前查询字段过滤性更好的索引。</strong><br><strong>2.对于组合索引，当前where查询中过滤性更好的字段在索引字段顺序中位置越靠前越好。</strong><br><strong>3.对于组合索引，尽量选择能够包含在当前查询中where子句中更多字段的索引。</strong><br><strong>4.尽可能通过分析统计信息和调整query的写法来达到选择合适索引的目的。</strong></p>
<h3 id="5、单表查询优化"><a href="#5、单表查询优化" class="headerlink" title="5、单表查询优化"></a>5、单表查询优化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- 单表查询优化</span><br><span class="line">CREATE TABLE IF NOT EXISTS article (</span><br><span class="line">id INT(10) PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">author_id INT(10) NOT NULL,</span><br><span class="line">category_id INT(10) NOT NULL,</span><br><span class="line">views INT(10) NOT NULL,</span><br><span class="line">comments INT(10) NOT NULL,</span><br><span class="line">title VARBINARY(255) NOT NULL,</span><br><span class="line">content TEXT NOT NULL</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">INSERT INTO article(author_id, category_id, views, comments, title, content) VALUES</span><br><span class="line">(1, 1, 1, 1, &#x27;1&#x27;, &#x27;1&#x27;),</span><br><span class="line">(2, 2, 2, 2, &#x27;2&#x27;, &#x27;2&#x27;),</span><br><span class="line">(1, 1, 3, 3, &#x27;3&#x27;, &#x27;3&#x27;);</span><br><span class="line"></span><br><span class="line">#1.查询category_id为1的，且comments大于1的情况下，views最多的id和author_id的信息</span><br><span class="line">explain select id,author_id </span><br><span class="line">from article</span><br><span class="line">where category_id=1 and comments&gt;1 order by views desc limit 1;</span><br><span class="line">#2.建立索引</span><br><span class="line">alter table article add index idx_ccv(category_id,comments,views);</span><br><span class="line">#3.再次测试</span><br><span class="line">explain select id,author_id </span><br><span class="line">from article</span><br><span class="line">where category_id=1 and comments&gt;1 order by views desc limit 1;</span><br><span class="line">#4.重新创建索引</span><br><span class="line">drop index idx_ccv on article;</span><br><span class="line">alter table article add index idx_cv(category_id,views);</span><br><span class="line">#5.再次测试</span><br><span class="line">explain select id,author_id </span><br><span class="line">from article</span><br><span class="line">where category_id=1 and comments&gt;1 order by views desc limit 1;</span><br></pre></td></tr></table></figure>

<h3 id="6、关联查询优化"><a href="#6、关联查询优化" class="headerlink" title="6、关联查询优化"></a>6、关联查询优化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS class (</span><br><span class="line">id INT(10) AUTO_INCREMENT,</span><br><span class="line">card INT(10),</span><br><span class="line">PRIMARY KEY (id)</span><br><span class="line">);</span><br><span class="line">CREATE TABLE IF NOT EXISTS book (</span><br><span class="line">bookid INT(10) AUTO_INCREMENT,</span><br><span class="line">card INT(10),</span><br><span class="line">PRIMARY KEY (bookid)</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO class(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line"> </span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line">INSERT INTO book(card) VALUES(FLOOR(1 + (RAND() * 20)));</span><br><span class="line"></span><br><span class="line">#1.联表查询</span><br><span class="line">explain select *</span><br><span class="line">from class</span><br><span class="line">left join book</span><br><span class="line">on class.card = book.card;</span><br><span class="line">#2.建立索引</span><br><span class="line">alter table book add index idx_card(card);</span><br><span class="line">#3.测试</span><br><span class="line">explain select *</span><br><span class="line">from class</span><br><span class="line">left join book</span><br><span class="line">on class.card = book.card;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>内连接时，mysql会自动把小结果集的选为驱动表，所以大表的字段最好加上索引。左外连接时，左表会全表扫描，所以右边大表字段最好加上索引，右外连接同理。我们最好保证被驱动表上的字段建立了索引。</strong></p>
<h3 id="7、排序优化"><a href="#7、排序优化" class="headerlink" title="7、排序优化"></a>7、排序优化</h3><p><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/1c79db4b8dd3bf793d7ea520415d3ded.png" alt="在这里插入图片描述"></p>
<p><strong>1.尽量避免使用Using FileSort方式排序。</strong><br><strong>2.order by语句使用索引最左前列或使用where子句与order by子句条件组合满足索引最左前列。</strong><br><strong>3.where子句中如果出现索引范围查询会导致order by索引失效。</strong></p>
<h3 id="8、分组优化"><a href="#8、分组优化" class="headerlink" title="8、分组优化"></a>8、分组优化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">drop table if exists students;</span><br><span class="line">CREATE TABLE students (</span><br><span class="line">  id INT PRIMARY KEY AUTO_INCREMENT COMMENT &quot;主键id&quot;,</span><br><span class="line">  sname VARCHAR (24) COMMENT &#x27;学生姓名&#x27;,</span><br><span class="line">  age INT COMMENT &#x27;年龄&#x27;,</span><br><span class="line">  score INT COMMENT &#x27;分数&#x27;,</span><br><span class="line">	time TIMESTAMP COMMENT &#x27;入学时间&#x27;</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">INSERT INTO students(sname,age,score,time) VALUES(&#x27;小明&#x27;,22,100,now());</span><br><span class="line">INSERT INTO students(sname,age,score,time) VALUES(&#x27;小红&#x27;,23,80,now());</span><br><span class="line">INSERT INTO students(sname,age,score,time) VALUES(&#x27;小绿&#x27;,24,80,now());</span><br><span class="line">INSERT INTO students(sname,age,score,time) VALUES(&#x27;黑&#x27;,23,70,now());</span><br><span class="line"></span><br><span class="line">-- 分组优化</span><br><span class="line">alter table students add index idx_sas(sname,age,score);</span><br><span class="line">explain select count(*),sname </span><br><span class="line">from students </span><br><span class="line">where sname=&quot;小明&quot; and age &gt; 22</span><br><span class="line">GROUP BY score;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">huangxinjian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/10/10/Mysql/">http://example.com/2024/10/10/Mysql/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">天上星星亮晶晶</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MYSQL/">MYSQL</a></div><div class="post_share"><div class="social-share" data-image="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/08/04/%E4%B9%90%E5%B0%9A%E4%BB%A3%E9%A9%BE/" title="乐尚代驾"><img class="cover" src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/1474917-20200316192657871-559666896.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">乐尚代驾</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/R-C.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">huangxinjian</div><div class="author-info__description">huangxinjian的博客</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MYSQL%E5%A4%8D%E4%B9%A0"><span class="toc-number">1.</span> <span class="toc-text">MYSQL复习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">一、分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81DDL"><span class="toc-number">1.2.</span> <span class="toc-text">二、DDL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.1.</span> <span class="toc-text">表查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%88%9B%E5%BB%BA"><span class="toc-number">1.2.2.</span> <span class="toc-text">表创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text">修改表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81mysql%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">三、mysql数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">数值类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.2.</span> <span class="toc-text">字符类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">日期类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AA%E7%9F%A5%E3%80%81%E7%B4%A2%E5%BC%95%E5%92%8C%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">未知、索引和索引优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8A%A3%E5%8A%BF"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.索引优劣势</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8A%BF"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">1.1索引优势</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2%E7%B4%A2%E5%BC%95%E5%8A%A3%E5%8A%BF"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">1.2索引劣势</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">1.3索引使用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.索引分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">2.1主键索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">2.2唯一索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%8D%95%E5%80%BC%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">2.3 单值索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">2.4组合索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90-EXPLAIN"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.性能分析(EXPLAIN)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Explain"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">3.1 Explain</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-id"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">3.2 id</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E6%9F%A5%E8%AF%A2%E7%B1%BB%E5%9E%8B%EF%BC%88select-type%EF%BC%89"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">3.3 查询类型（select_type）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-table"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">3.4 table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-type"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">3.5 type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#System%EF%BC%9A"><span class="toc-number">1.4.3.5.1.</span> <span class="toc-text">System：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Const%EF%BC%9A"><span class="toc-number">1.4.3.5.2.</span> <span class="toc-text">Const：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#eq-ref%EF%BC%9A"><span class="toc-number">1.4.3.5.3.</span> <span class="toc-text">eq_ref：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Ref%EF%BC%9A"><span class="toc-number">1.4.3.5.4.</span> <span class="toc-text">Ref：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Range%EF%BC%9A"><span class="toc-number">1.4.3.5.5.</span> <span class="toc-text">Range：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Index%EF%BC%9A"><span class="toc-number">1.4.3.5.6.</span> <span class="toc-text">Index：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#All%EF%BC%9A"><span class="toc-number">1.4.3.5.7.</span> <span class="toc-text">All：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="toc-number">1.4.3.5.8.</span> <span class="toc-text">性能对比</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-possible-keys"><span class="toc-number">1.4.3.6.</span> <span class="toc-text">4.possible_keys</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-key"><span class="toc-number">1.4.3.7.</span> <span class="toc-text">5.key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-ref"><span class="toc-number">1.4.3.8.</span> <span class="toc-text">6.ref</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-rows"><span class="toc-number">1.4.3.9.</span> <span class="toc-text">7.rows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-Extra"><span class="toc-number">1.4.3.10.</span> <span class="toc-text">8.Extra</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Using-filesort%EF%BC%9A"><span class="toc-number">1.4.3.10.1.</span> <span class="toc-text">Using filesort：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Using-temporary%EF%BC%9A"><span class="toc-number">1.4.3.10.2.</span> <span class="toc-text">Using temporary：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Using-index%EF%BC%9A"><span class="toc-number">1.4.3.10.3.</span> <span class="toc-text">Using index：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%EF%BC%88%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%89"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.查询优化（索引失效）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E6%9C%80%E4%BD%B3%E5%B7%A6%E5%89%8D%E7%BC%80%E6%B3%95%E5%88%99%EF%BC%9A"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">1、最佳左前缀法则：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%B8%8D%E5%9C%A8%E7%B4%A2%E5%BC%95%E5%88%97%E4%B8%8A%E5%81%9A%E4%BB%BB%E4%BD%95%E8%AE%A1%E7%AE%97%E3%80%81%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BC%9A%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E8%80%8C%E8%BD%AC%E5%90%91%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E3%80%82"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">2、不在索引列上做任何计算、函数操作，会导致索引失效而转向全表扫描。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E4%B8%AD%E8%8C%83%E5%9B%B4%E6%9D%A1%E4%BB%B6%E5%8F%B3%E8%BE%B9%E7%9A%84%E5%88%97%E3%80%82"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">3.存储引擎不能使用索引中范围条件右边的列。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81Mysql%E5%9C%A8%E4%BD%BF%E7%94%A8%E4%B8%8D%E7%AD%89%E4%BA%8E%E6%97%B6%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E4%BC%9A%E5%AF%BC%E8%87%B4%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E3%80%82"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">4、Mysql在使用不等于时无法使用索引会导致全表扫描。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81is-null%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%EF%BC%8C%E4%BD%86%E6%98%AFis-not-null%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E3%80%82"><span class="toc-number">1.4.4.5.</span> <span class="toc-text">5、is null可以使用索引，但是is not null无法使用索引。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81like%E4%BB%A5%E9%80%9A%E9%85%8D%E7%AC%A6%E5%BC%80%E5%A4%B4%E4%BC%9A%E4%BD%BF%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E5%AF%BC%E8%87%B4%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E3%80%82"><span class="toc-number">1.4.4.6.</span> <span class="toc-text">6、like以通配符开头会使索引失效导致全表扫描。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8D%E5%8A%A0%E5%8D%95%E5%BC%95%E5%8F%B7%E7%B4%A2%E5%BC%95%E4%BC%9A%E5%A4%B1%E6%95%88%E3%80%82"><span class="toc-number">1.4.4.7.</span> <span class="toc-text">7、字符串不加单引号索引会失效。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81%E4%BD%BF%E7%94%A8or%E8%BF%9E%E6%8E%A5%E6%97%B6%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E3%80%82"><span class="toc-number">1.4.4.8.</span> <span class="toc-text">8、使用or连接时索引失效。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.4.4.9.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.5.</span> <span class="toc-text">5、单表查询优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.6.</span> <span class="toc-text">6、关联查询优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E6%8E%92%E5%BA%8F%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.7.</span> <span class="toc-text">7、排序优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%88%86%E7%BB%84%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.8.</span> <span class="toc-text">8、分组优化</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/10/10/Mysql/" title="MYSQL复习"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MYSQL复习"/></a><div class="content"><a class="title" href="/2024/10/10/Mysql/" title="MYSQL复习">MYSQL复习</a><time datetime="2024-10-10T02:05:36.000Z" title="发表于 2024-10-10 10:05:36">2024-10-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/04/%E4%B9%90%E5%B0%9A%E4%BB%A3%E9%A9%BE/" title="乐尚代驾"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/1474917-20200316192657871-559666896.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="乐尚代驾"/></a><div class="content"><a class="title" href="/2024/08/04/%E4%B9%90%E5%B0%9A%E4%BB%A3%E9%A9%BE/" title="乐尚代驾">乐尚代驾</a><time datetime="2024-08-04T08:05:36.000Z" title="发表于 2024-08-04 16:05:36">2024-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/04/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1/" title="黑马头条"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/1474917-20200316192657871-559666896.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="黑马头条"/></a><div class="content"><a class="title" href="/2024/08/04/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1/" title="黑马头条">黑马头条</a><time datetime="2024-08-04T07:12:12.000Z" title="发表于 2024-08-04 15:12:12">2024-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/03/Redis%E5%85%A5%E9%97%A8/" title="Redis入门"><img src="https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis入门"/></a><div class="content"><a class="title" href="/2024/08/03/Redis%E5%85%A5%E9%97%A8/" title="Redis入门">Redis入门</a><time datetime="2024-08-03T08:05:36.000Z" title="发表于 2024-08-03 16:05:36">2024-08-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/03/WebSocket/" title="WebSocket">WebSocket</a><time datetime="2024-08-03T08:05:36.000Z" title="发表于 2024-08-03 16:05:36">2024-08-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://typora-1328334712.cos.ap-beijing.myqcloud.com/img/202408041416746.jpeg')"><div id="footer-wrap"><div class="copyright">&copy;2024 By huangxinjian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>